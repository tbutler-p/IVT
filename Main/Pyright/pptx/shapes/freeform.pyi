"""
This type stub file was generated by pyright.
"""

from typing import Iterable, Iterator, Sequence, TYPE_CHECKING
from pptx.util import Length
from typing_extensions import TypeAlias
from pptx.oxml.shapes.autoshape import CT_Path2D, CT_Path2DClose, CT_Path2DLineTo, CT_Path2DMoveTo
from pptx.shapes.shapetree import _BaseGroupShapes

"""Objects related to construction of freeform shapes."""
if TYPE_CHECKING:
    ...
CT_DrawingOperation: TypeAlias = "CT_Path2DClose | CT_Path2DLineTo | CT_Path2DMoveTo"
DrawingOperation: TypeAlias = "_LineSegment | _MoveTo | _Close"
class FreeformBuilder(Sequence[DrawingOperation]):
    """Allows a freeform shape to be specified and created.

    The initial pen position is provided on construction. From there, drawing proceeds using
    successive calls to draw line segments. The freeform shape may be closed by calling the
    :meth:`close` method.

    A shape may have more than one contour, in which case overlapping areas are "subtracted". A
    contour is a sequence of line segments beginning with a "move-to" operation. A move-to
    operation is automatically inserted in each new freeform; additional move-to ops can be
    inserted with the `.move_to()` method.
    """
    def __init__(self, shapes: _BaseGroupShapes, start_x: Length, start_y: Length, x_scale: float, y_scale: float) -> None:
        ...
    
    def __getitem__(self, idx: int) -> DrawingOperation:
        ...
    
    def __iter__(self) -> Iterator[DrawingOperation]:
        ...
    
    def __len__(self): # -> int:
        ...
    
    @classmethod
    def new(cls, shapes: _BaseGroupShapes, start_x: float, start_y: float, x_scale: float, y_scale: float): # -> Self:
        """Return a new |FreeformBuilder| object.

        The initial pen location is specified (in local coordinates) by
        (`start_x`, `start_y`).
        """
        ...
    
    def add_line_segments(self, vertices: Iterable[tuple[float, float]], close: bool = ...): # -> Self:
        """Add a straight line segment to each point in `vertices`.

        `vertices` must be an iterable of (x, y) pairs (2-tuples). Each x and y value is rounded
        to the nearest integer before use. The optional `close` parameter determines whether the
        resulting contour is `closed` or left `open`.

        Returns this |FreeformBuilder| object so it can be used in chained calls.
        """
        ...
    
    def convert_to_shape(self, origin_x: Length = ..., origin_y: Length = ...): # -> BaseShape:
        """Return new freeform shape positioned relative to specified offset.

        `origin_x` and `origin_y` locate the origin of the local coordinate system in slide
        coordinates (EMU), perhaps most conveniently by use of a |Length| object.

        Note that this method may be called more than once to add multiple shapes of the same
        geometry in different locations on the slide.
        """
        ...
    
    def move_to(self, x: float, y: float): # -> Self:
        """Move pen to (x, y) (local coordinates) without drawing line.

        Returns this |FreeformBuilder| object so it can be used in chained calls.
        """
        ...
    
    @property
    def shape_offset_x(self) -> Length:
        """Return x distance of shape origin from local coordinate origin.

        The returned integer represents the leftmost extent of the freeform shape, in local
        coordinates. Note that the bounding box of the shape need not start at the local origin.
        """
        ...
    
    @property
    def shape_offset_y(self) -> Length:
        """Return y distance of shape origin from local coordinate origin.

        The returned integer represents the topmost extent of the freeform shape, in local
        coordinates. Note that the bounding box of the shape need not start at the local origin.
        """
        ...
    


class _BaseDrawingOperation:
    """Base class for freeform drawing operations.

    A drawing operation has at least one location (x, y) in local coordinates.
    """
    def __init__(self, freeform_builder: FreeformBuilder, x: Length, y: Length) -> None:
        ...
    
    def apply_operation_to(self, path: CT_Path2D) -> CT_DrawingOperation:
        """Add the XML element(s) implementing this operation to `path`.

        Must be implemented by each subclass.
        """
        ...
    
    @property
    def x(self) -> Length:
        """Return the horizontal (x) target location of this operation.

        The returned value is an integer in local coordinates.
        """
        ...
    
    @property
    def y(self) -> Length:
        """Return the vertical (y) target location of this operation.

        The returned value is an integer in local coordinates.
        """
        ...
    


class _Close:
    """Specifies adding a `<a:close/>` element to the current contour."""
    @classmethod
    def new(cls) -> _Close:
        """Return a new _Close object."""
        ...
    
    def apply_operation_to(self, path: CT_Path2D) -> CT_Path2DClose:
        """Add `a:close` element to `path`."""
        ...
    


class _LineSegment(_BaseDrawingOperation):
    """Specifies a straight line segment ending at the specified point."""
    @classmethod
    def new(cls, freeform_builder: FreeformBuilder, x: float, y: float) -> _LineSegment:
        """Return a new _LineSegment object ending at point *(x, y)*.

        Both `x` and `y` are rounded to the nearest integer before use.
        """
        ...
    
    def apply_operation_to(self, path: CT_Path2D) -> CT_Path2DLineTo:
        """Add `a:lnTo` element to `path` for this line segment.

        Returns the `a:lnTo` element newly added to the path.
        """
        ...
    


class _MoveTo(_BaseDrawingOperation):
    """Specifies a new pen position."""
    @classmethod
    def new(cls, freeform_builder: FreeformBuilder, x: float, y: float) -> _MoveTo:
        """Return a new _MoveTo object for move to point `(x, y)`.

        Both `x` and `y` are rounded to the nearest integer before use.
        """
        ...
    
    def apply_operation_to(self, path: CT_Path2D) -> CT_Path2DMoveTo:
        """Add `a:moveTo` element to `path` for this line segment."""
        ...
    



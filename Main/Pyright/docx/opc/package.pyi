"""
This type stub file was generated by pyright.
"""

from typing import IO, Iterator, TYPE_CHECKING
from docx.opc.packuri import PackURI
from docx.opc.part import Part
from docx.opc.rel import _Relationship
from docx.shared import lazyproperty
from typing_extensions import Self
from docx.opc.coreprops import CoreProperties

"""Objects that implement reading and writing OPC packages."""
if TYPE_CHECKING:
    ...
class OpcPackage:
    """Main API class for |python-opc|.

    A new instance is constructed by calling the :meth:`open` class method with a path
    to a package file or file-like object containing one.
    """
    def after_unmarshal(self): # -> None:
        """Entry point for any post-unmarshaling processing.

        May be overridden by subclasses without forwarding call to super.
        """
        ...
    
    @property
    def core_properties(self) -> CoreProperties:
        """|CoreProperties| object providing read/write access to the Dublin Core
        properties for this document."""
        ...
    
    def iter_rels(self) -> Iterator[_Relationship]:
        """Generate exactly one reference to each relationship in the package by
        performing a depth-first traversal of the rels graph."""
        ...
    
    def iter_parts(self) -> Iterator[Part]:
        """Generate exactly one reference to each of the parts in the package by
        performing a depth-first traversal of the rels graph."""
        ...
    
    def load_rel(self, reltype: str, target: Part | str, rId: str, is_external: bool = ...): # -> _Relationship:
        """Return newly added |_Relationship| instance of `reltype` between this part
        and `target` with key `rId`.

        Target mode is set to ``RTM.EXTERNAL`` if `is_external` is |True|. Intended for
        use during load from a serialized package, where the rId is well known. Other
        methods exist for adding a new relationship to the package during processing.
        """
        ...
    
    @property
    def main_document_part(self): # -> Part:
        """Return a reference to the main document part for this package.

        Examples include a document part for a WordprocessingML package, a presentation
        part for a PresentationML package, or a workbook part for a SpreadsheetML
        package.
        """
        ...
    
    def next_partname(self, template: str) -> PackURI:
        """Return a |PackURI| instance representing partname matching `template`.

        The returned part-name has the next available numeric suffix to distinguish it
        from other parts of its type. `template` is a printf (%)-style template string
        containing a single replacement item, a '%d' to be used to insert the integer
        portion of the partname. Example: "/word/header%d.xml"
        """
        ...
    
    @classmethod
    def open(cls, pkg_file: str | IO[bytes]) -> Self:
        """Return an |OpcPackage| instance loaded with the contents of `pkg_file`."""
        ...
    
    def part_related_by(self, reltype: str) -> Part:
        """Return part to which this package has a relationship of `reltype`.

        Raises |KeyError| if no such relationship is found and |ValueError| if more than
        one such relationship is found.
        """
        ...
    
    @property
    def parts(self) -> list[Part]:
        """Return a list containing a reference to each of the parts in this package."""
        ...
    
    def relate_to(self, part: Part, reltype: str): # -> str:
        """Return rId key of new or existing relationship to `part`.

        If a relationship of `reltype` to `part` already exists, its rId is returned. Otherwise a
        new relationship is created and that rId is returned.
        """
        ...
    
    @lazyproperty
    def rels(self): # -> Relationships:
        """Return a reference to the |Relationships| instance holding the collection of
        relationships for this package."""
        ...
    
    def save(self, pkg_file: str | IO[bytes]): # -> None:
        """Save this package to `pkg_file`.

        `pkg_file` can be either a file-path or a file-like object.
        """
        ...
    


class Unmarshaller:
    """Hosts static methods for unmarshalling a package from a |PackageReader|."""
    @staticmethod
    def unmarshal(pkg_reader, package, part_factory): # -> None:
        """Construct graph of parts and realized relationships based on the contents of
        `pkg_reader`, delegating construction of each part to `part_factory`.

        Package relationships are added to `pkg`.
        """
        ...
    



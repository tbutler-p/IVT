"""
This type stub file was generated by pyright.
"""

from dataclasses import dataclass
from typing import TypedDict
from pydantic_core.core_schema import ComputedField, CoreSchema, DefinitionReferenceSchema, SerSchema
from typing_extensions import TypeAlias

AllSchemas: TypeAlias = 'CoreSchema | SerSchema | ComputedField'
class GatherResult(TypedDict):
    """Schema traversing result."""
    collected_references: dict[str, DefinitionReferenceSchema | None]
    deferred_discriminator_schemas: list[CoreSchema]
    ...


class MissingDefinitionError(LookupError):
    """A reference was pointing to a non-existing core schema."""
    def __init__(self, schema_reference: str, /) -> None:
        ...
    


@dataclass
class GatherContext:
    """The current context used during core schema traversing.

    Context instances should only be used during schema traversing.
    """
    definitions: dict[str, CoreSchema]
    deferred_discriminator_schemas: list[CoreSchema] = ...
    collected_references: dict[str, DefinitionReferenceSchema | None] = ...


def traverse_metadata(schema: AllSchemas, ctx: GatherContext) -> None:
    ...

def traverse_definition_ref(def_ref_schema: DefinitionReferenceSchema, ctx: GatherContext) -> None:
    ...

def traverse_schema(schema: AllSchemas, context: GatherContext) -> None:
    ...

def gather_schemas_for_cleaning(schema: CoreSchema, definitions: dict[str, CoreSchema]) -> GatherResult:
    """Traverse the core schema and definitions and return the necessary information for schema cleaning.

    During the core schema traversing, any `'definition-ref'` schema is:

    - Validated: the reference must point to an existing definition. If this is not the case, a
      `MissingDefinitionError` exception is raised.
    - Stored in the context: the actual reference is stored in the context. Depending on whether
      the `'definition-ref'` schema is encountered more that once, the schema itself is also
      saved in the context to be inlined (i.e. replaced by the definition it points to).
    """
    ...


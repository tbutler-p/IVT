"""
This type stub file was generated by pyright.
"""

import abc
from typing import Any, IO, NamedTuple
from . import Image
from ._typing import StrOrBytesPath

TYPE_CHECKING = ...
if TYPE_CHECKING:
    ...
logger = ...
MAXBLOCK = ...
SAFEBLOCK = ...
LOAD_TRUNCATED_IMAGES = ...
ERRORS = ...
def raise_oserror(error: int) -> OSError:
    ...

class _Tile(NamedTuple):
    codec_name: str
    extents: tuple[int, int, int, int] | None
    offset: int = ...
    args: tuple[Any, ...] | str | None = ...


class ImageFile(Image.Image):
    """Base class for image file format handlers."""
    def __init__(self, fp: StrOrBytesPath | IO[bytes], filename: str | bytes | None = ...) -> None:
        ...
    
    def close(self) -> None:
        """
        Closes the file pointer, if possible.

        This operation will destroy the image core and release its memory.
        The image data will be unusable afterward.

        This function is required to close images that have multiple frames or
        have not had their file read and closed by the
        :py:meth:`~PIL.Image.Image.load` method. See :ref:`file-handling` for
        more information.
        """
        ...
    
    def get_child_images(self) -> list[ImageFile]:
        ...
    
    def get_format_mimetype(self) -> str | None:
        ...
    
    def __getstate__(self) -> list[Any]:
        ...
    
    def __setstate__(self, state: list[Any]) -> None:
        ...
    
    def verify(self) -> None:
        """Check file integrity"""
        ...
    
    def load(self) -> Image.core.PixelAccess | None:
        """Load image data based on tile list"""
        ...
    
    def load_prepare(self) -> None:
        ...
    
    def load_end(self) -> None:
        ...
    


class StubHandler(abc.ABC):
    def open(self, im: StubImageFile) -> None:
        ...
    
    @abc.abstractmethod
    def load(self, im: StubImageFile) -> Image.Image:
        ...
    


class StubImageFile(ImageFile, metaclass=abc.ABCMeta):
    """
    Base class for stub image loaders.

    A stub loader is an image loader that can identify files of a
    certain format, but relies on external code to load the file.
    """
    def load(self) -> Image.core.PixelAccess | None:
        ...
    


class Parser:
    """
    Incremental image parser.  This class implements the standard
    feed/close consumer interface.
    """
    incremental = ...
    image: Image.Image | None = ...
    data: bytes | None = ...
    decoder: Image.core.ImagingDecoder | PyDecoder | None = ...
    offset = ...
    finished = ...
    def reset(self) -> None:
        """
        (Consumer) Reset the parser.  Note that you can only call this
        method immediately after you've created a parser; parser
        instances cannot be reused.
        """
        ...
    
    def feed(self, data: bytes) -> None:
        """
        (Consumer) Feed data to the parser.

        :param data: A string buffer.
        :exception OSError: If the parser failed to parse the image file.
        """
        ...
    
    def __enter__(self) -> Parser:
        ...
    
    def __exit__(self, *args: object) -> None:
        ...
    
    def close(self) -> Image.Image:
        """
        (Consumer) Close the stream.

        :returns: An image object.
        :exception OSError: If the parser failed to parse the image file either
                            because it cannot be identified or cannot be
                            decoded.
        """
        ...
    


class PyCodecState:
    def __init__(self) -> None:
        ...
    
    def extents(self) -> tuple[int, int, int, int]:
        ...
    


class PyCodec:
    fd: IO[bytes] | None
    def __init__(self, mode: str, *args: Any) -> None:
        ...
    
    def init(self, args: tuple[Any, ...]) -> None:
        """
        Override to perform codec specific initialization

        :param args: Tuple of arg items from the tile entry
        :returns: None
        """
        ...
    
    def cleanup(self) -> None:
        """
        Override to perform codec specific cleanup

        :returns: None
        """
        ...
    
    def setfd(self, fd: IO[bytes]) -> None:
        """
        Called from ImageFile to set the Python file-like object

        :param fd: A Python file-like object
        :returns: None
        """
        ...
    
    def setimage(self, im: Image.core.ImagingCore, extents: tuple[int, int, int, int] | None = ...) -> None:
        """
        Called from ImageFile to set the core output image for the codec

        :param im: A core image object
        :param extents: a 4 tuple of (x0, y0, x1, y1) defining the rectangle
            for this tile
        :returns: None
        """
        ...
    


class PyDecoder(PyCodec):
    """
    Python implementation of a format decoder. Override this class and
    add the decoding logic in the :meth:`decode` method.

    See :ref:`Writing Your Own File Codec in Python<file-codecs-py>`
    """
    _pulls_fd = ...
    @property
    def pulls_fd(self) -> bool:
        ...
    
    def decode(self, buffer: bytes | Image.SupportsArrayInterface) -> tuple[int, int]:
        """
        Override to perform the decoding process.

        :param buffer: A bytes object with the data to be decoded.
        :returns: A tuple of ``(bytes consumed, errcode)``.
            If finished with decoding return -1 for the bytes consumed.
            Err codes are from :data:`.ImageFile.ERRORS`.
        """
        ...
    
    def set_as_raw(self, data: bytes, rawmode: str | None = ..., extra: tuple[Any, ...] = ...) -> None:
        """
        Convenience method to set the internal image from a stream of raw data

        :param data: Bytes to be set
        :param rawmode: The rawmode to be used for the decoder.
            If not specified, it will default to the mode of the image
        :param extra: Extra arguments for the decoder.
        :returns: None
        """
        ...
    


class PyEncoder(PyCodec):
    """
    Python implementation of a format encoder. Override this class and
    add the decoding logic in the :meth:`encode` method.

    See :ref:`Writing Your Own File Codec in Python<file-codecs-py>`
    """
    _pushes_fd = ...
    @property
    def pushes_fd(self) -> bool:
        ...
    
    def encode(self, bufsize: int) -> tuple[int, int, bytes]:
        """
        Override to perform the encoding process.

        :param bufsize: Buffer size.
        :returns: A tuple of ``(bytes encoded, errcode, bytes)``.
            If finished with encoding return 1 for the error code.
            Err codes are from :data:`.ImageFile.ERRORS`.
        """
        ...
    
    def encode_to_pyfd(self) -> tuple[int, int]:
        """
        If ``pushes_fd`` is ``True``, then this method will be used,
        and ``encode()`` will only be called once.

        :returns: A tuple of ``(bytes consumed, errcode)``.
            Err codes are from :data:`.ImageFile.ERRORS`.
        """
        ...
    
    def encode_to_file(self, fh: int, bufsize: int) -> int:
        """
        :param fh: File handle.
        :param bufsize: Buffer size.

        :returns: If finished successfully, return 0.
            Otherwise, return an error code. Err codes are from
            :data:`.ImageFile.ERRORS`.
        """
        ...
    



"""
This type stub file was generated by pyright.
"""

from io import BytesIO
from pathlib import Path
from typing import Annotated, Union
from docling_core.types.doc import DoclingDocument
from pydantic import BaseModel, Field, NonNegativeInt, PositiveInt
from pydantic.dataclasses import dataclass
from typing_extensions import override
from docling.backend.abstract_backend import DeclarativeDocumentBackend, PaginatedDocumentBackend
from docling.datamodel.base_models import InputFormat
from docling.datamodel.document import InputDocument

_log = ...
@dataclass
class DataRegion:
    """Represents the bounding rectangle of non-empty cells in a worksheet."""
    min_row: Annotated[PositiveInt, Field(description="Smallest row index (1-based index).")]
    max_row: Annotated[PositiveInt, Field(description="Largest row index (1-based index).")]
    min_col: Annotated[PositiveInt, Field(description="Smallest column index (1-based index).")]
    max_col: Annotated[PositiveInt, Field(description="Largest column index (1-based index).")]
    def width(self) -> PositiveInt:
        """Number of columns in the data region."""
        ...
    
    def height(self) -> PositiveInt:
        """Number of rows in the data region."""
        ...
    


class ExcelCell(BaseModel):
    """Represents an Excel cell.

    Attributes:
        row: The row number of the cell.
        col: The column number of the cell.
        text: The text content of the cell.
        row_span: The number of rows the cell spans.
        col_span: The number of columns the cell spans.
    """
    row: int
    col: int
    text: str
    row_span: int
    col_span: int
    ...


class ExcelTable(BaseModel):
    """Represents an Excel table on a worksheet.

    Attributes:
        anchor: The column and row indices of the upper-left cell of the table
        (0-based index).
        num_rows: The number of rows in the table.
        num_cols: The number of columns in the table.
        data: The data in the table, represented as a list of ExcelCell objects.
    """
    anchor: tuple[NonNegativeInt, NonNegativeInt]
    num_rows: int
    num_cols: int
    data: list[ExcelCell]
    ...


class MsExcelDocumentBackend(DeclarativeDocumentBackend, PaginatedDocumentBackend):
    """Backend for parsing Excel workbooks.

    The backend converts an Excel workbook into a DoclingDocument object.
    Each worksheet is converted into a separate page.
    The following elements are parsed:
    - Cell contents, parsed as tables. If two groups of cells are disconnected
    between each other, they will be parsed as two different tables.
    - Images, parsed as PictureItem objects.

    The DoclingDocument tables and pictures have their provenance information, including
    the position in their original Excel worksheet. The position is represented by a
    bounding box object with the cell indices as units (0-based index). The size of this
    bounding box is the number of columns and rows that the table or picture spans.
    """
    @override
    def __init__(self, in_doc: InputDocument, path_or_stream: Union[BytesIO, Path]) -> None:
        """Initialize the MsExcelDocumentBackend object.

        Parameters:
            in_doc: The input document object.
            path_or_stream: The path or stream to the Excel file.

        Raises:
            RuntimeError: An error occurred parsing the file.
        """
        ...
    
    @override
    def is_valid(self) -> bool:
        ...
    
    @classmethod
    @override
    def supports_pagination(cls) -> bool:
        ...
    
    @override
    def page_count(self) -> int:
        ...
    
    @classmethod
    @override
    def supported_formats(cls) -> set[InputFormat]:
        ...
    
    @override
    def convert(self) -> DoclingDocument:
        """Parse the Excel workbook into a DoclingDocument object.

        Raises:
            RuntimeError: Unable to run the conversion since the backend object failed to
            initialize.

        Returns:
            The DoclingDocument object representing the Excel workbook.
        """
        ...
    


